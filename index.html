<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.7">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html lang="en"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;meta charset="UTF-8" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"/&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;title&gt;Buctril Engagement Session Analysis Report&lt;/title&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;script src="https://cdn.jsdelivr.net/npm/chart.js"&gt;&lt;/script&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"&gt;&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" /&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>* {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>margin: 0;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>padding: 0;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>box-sizing: border-box;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>body {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>background: #f8f9fa;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>color: #333;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>line-height: 1.6;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>position: relative;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>min-height: 100vh;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>/* Video Background - Configured for loop and zoom (object-fit: cover) */</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.video-background {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>position: fixed;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>top: 0;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>left: 0;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>height: 100%;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>z-index: -1;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>overflow: hidden;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.video-background video {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>height: 100%;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>object-fit: cover; /* Ensures video is zoomed and covers the whole viewport */</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>opacity: 0.18;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>filter: blur(3px) brightness(0.8);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.overlay {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>position: relative;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>background: rgba(255, 255, 255, 0.96);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>backdrop-filter: blur(10px);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>min-height: 100vh;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>/* Header */</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.header {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>background: linear-gradient(135deg, #2c3e50, #3498db);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>color: white;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>padding: 2rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>text-align: center;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>border-bottom: 5px solid #e74c3c;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.header h1 {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>font-size: 2.5rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>margin-bottom: 0.5rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>text-shadow: 2px 2px 4px rgba(0,0,0,0.3);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.header p {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>font-size: 1.1rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>opacity: 0.9;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>/* Status Indicator */</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.status-indicator {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>background: #f39c12;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>color: white;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>padding: 0.5rem 1rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>border-radius: 20px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>font-size: 0.9rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>margin-top: 0.5rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>display: inline-block;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>/* Loading Overlay */</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.loading-overlay {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>position: fixed;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>top: 0;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>left: 0;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>height: 100%;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>background: rgba(255, 255, 255, 0.95);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>flex-direction: column;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>justify-content: center;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>align-items: center;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>z-index: 9999;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>transition: opacity 0.3s;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.loading-spinner {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>width: 50px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>height: 50px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>border: 5px solid #f3f3f3;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>border-top: 5px solid #3498db;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>border-radius: 50%;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>animation: spin 1s linear infinite;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>margin-bottom: 1rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>@keyframes spin {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>0% { transform: rotate(0deg); }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>100% { transform: rotate(360deg); }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>/* Error Message */</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.error-message {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>background: #e74c3c;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>color: white;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>padding: 1rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>border-radius: 10px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>margin: 1rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>display: none;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>text-align: center;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>/* Main Container */</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.container {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>max-width: 1400px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>margin: 0 auto;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>padding: 2rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>/* Dashboard Layout */</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.dashboard {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>display: grid;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>grid-template-columns: 1fr 1fr;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>gap: 2rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>margin-bottom: 2rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>@media (max-width: 1024px) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>.dashboard {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>grid-template-columns: 1fr;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>/* Map Container */</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.map-container {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>grid-column: 1 / -1;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>background: white;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>border-radius: 15px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>box-shadow: 0 10px 30px rgba(0,0,0,0.1);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>overflow: hidden;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>padding: 1.5rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>border: 1px solid #e0e0e0;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>margin-bottom: 2rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.map-container h2 {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>color: #2c3e50;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>margin-bottom: 1rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>padding-bottom: 0.5rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>border-bottom: 2px solid #3498db;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>#map {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>height: 500px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>border-radius: 10px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>overflow: hidden;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>border: 1px solid #ddd;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>/* Map Controls */</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.map-controls {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>gap: 1rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>margin-top: 1rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>flex-wrap: wrap;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>align-items: center;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>margin-bottom: 1rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.map-controls select,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.map-controls button {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>padding: 0.5rem 1rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>border: 2px solid #3498db;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>background: white;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>color: #2c3e50;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>border-radius: 5px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>cursor: pointer;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>font-weight: 600;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>transition: all 0.3s ease;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.map-controls select:hover,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.map-controls button:hover {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>background: #3498db;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>color: white;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>/* Cards */</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.card {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>background: white;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>border-radius: 15px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>padding: 1.5rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>box-shadow: 0 5px 20px rgba(0,0,0,0.08);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>border: 1px solid #e0e0e0;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>transition: transform 0.3s ease;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.card:hover {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>transform: translateY(-5px);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.card h3 {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>color: #2c3e50;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>margin-bottom: 1rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>align-items: center;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>gap: 0.5rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>/* Summary Section */</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.summary-grid {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>display: grid;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>gap: 1.5rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>margin-top: 1rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.summary-item {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>background: linear-gradient(135deg, #f8f9fa, #e9ecef);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>padding: 1rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>border-radius: 10px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>border-left: 4px solid #3498db;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.summary-item strong {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>color: #2c3e50;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>font-size: 1.1rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.summary-item p {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>color: #666;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>margin-top: 0.5rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>/* Charts */</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.chart-container {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>background: white;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>border-radius: 15px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>padding: 1.5rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>box-shadow: 0 5px 20px rgba(0,0,0,0.08);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>margin-top: 2rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.charts-grid {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>display: grid;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>gap: 2rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>margin-top: 2rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>/* Table */</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.data-table {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>border-collapse: collapse;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>margin-top: 1rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>background: white;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>border-radius: 10px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>overflow: hidden;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>box-shadow: 0 0 15px rgba(0,0,0,0.05);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.data-table th {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>background: linear-gradient(135deg, #3498db, #2980b9);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>color: white;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>padding: 1rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>text-align: left;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>font-weight: 600;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.data-table td {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>padding: 0.8rem 1rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>border-bottom: 1px solid #eee;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>font-size: 0.9rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.data-table tr:hover {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>background: #f8f9fa;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.data-table tbody tr:last-child td {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>border-bottom: none;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.table-container {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>overflow-x: auto;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>margin-top: 1rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>/* Session Details */</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.session-details {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>background: white;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>border-radius: 15px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>padding: 1.5rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>margin-top: 2rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>box-shadow: 0 5px 20px rgba(0,0,0,0.08);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.session-list {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>display: grid;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>gap: 1rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>margin-top: 1rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.session-item {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>background: linear-gradient(135deg, #f8f9fa, #e9ecef);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>padding: 1rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>border-radius: 10px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>border-left: 4px solid #e74c3c;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>/* KPI Metrics */</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.kpi-grid {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>display: grid;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>gap: 1rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>margin-top: 1rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.kpi-item {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>text-align: center;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>padding: 1rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>background: linear-gradient(135deg, #2c3e50, #34495e);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>color: white;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>border-radius: 10px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.kpi-value {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>font-size: 2rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>font-weight: bold;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>margin: 0.5rem 0;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.kpi-label {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>font-size: 0.9rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>opacity: 0.9;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>/* Data Info */</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.data-info {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>background: #e8f4fc;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>border-left: 4px solid #3498db;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>padding: 1rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>margin: 1rem 0;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>border-radius: 5px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>/* Footer */</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.footer {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>text-align: center;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>padding: 2rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>margin-top: 3rem;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>background: #2c3e50;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>color: white;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>border-top: 5px solid #3498db;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>/* Animations */</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>@keyframes fadeIn {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>from { opacity: 0; transform: translateY(20px); }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>to { opacity: 1; transform: translateY(0); }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.fade-in {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>animation: fadeIn 0.6s ease forwards;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>/* Responsive Design */</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>@media (max-width: 768px) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>.container { padding: 1rem; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>.header h1 { font-size: 2rem; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>.charts-grid { grid-template-columns: 1fr; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>#map { height: 300px; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>.map-controls { flex-direction: column; align-items: stretch; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>.map-controls select, .map-controls button, .status-indicator { width: 100%; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;div class="loading-overlay" id="loadingOverlay"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="loading-spinner"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;p&gt;Loading engagement data and initializing map...&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;p class="status-indicator" id="dataStatus"&gt;Awaiting data&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;div class="error-message" id="errorMessage"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;p&gt;Error loading data. Please check console for details.&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;button onclick="retryLoad()" style="margin-top: 0.5rem; padding: 0.5rem 1rem; background: white; color: #e74c3c; border: none; border-radius: 5px; cursor: pointer;"&gt; Retry &lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;div class="video-background"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;video autoplay muted loop playsinline&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;source src="tmp.mp4" type="video/mp4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>Your browser does not support the video tag.</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/video&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;div class="overlay"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;header class="header"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;h1&gt;Buctril Engagement Session Impact Report&lt;/h1&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;p&gt;Interactive analysis of farmer engagement, product awareness, and market conversion.&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;p style="font-size: 0.8rem; margin-top: 10px;"&gt;Sessions Loaded: &lt;strong id="sessionCount"&gt;0&lt;/strong&gt; | Last Update: &lt;span id="updateTime"&gt;N/A&lt;/span&gt;&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/header&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="container"&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;section class="map-container fade-in"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;h2&gt;ğŸ“ Interactive Session Map&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;p class="data-info"&gt;Markers are sized by **Total Farmers** and colored by **Awareness Rate**. Use the filters below for day/week-wise view.&lt;/p&gt;</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="map-controls"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;select id="dayFilter"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;option value="All"&gt;Filter by Day&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/select&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;select id="weekFilter"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;option value="All"&gt;Filter by Week&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/select&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;span class="status-indicator" id="currentFilterDisplay"&gt;Showing: All Sessions&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div id="map"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;/section&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="dashboard fade-in"&gt;</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="card"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;h3&gt;ğŸ“Š Current Filter Summary&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div class="summary-grid" id="currentSummaryGrid"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="summary-item"&gt; &lt;strong&gt;Total Sessions&lt;/strong&gt; &lt;p id="totalSessions"&gt;Loading...&lt;/p&gt; &lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="summary-item"&gt; &lt;strong&gt;Total Farmers Engaged&lt;/strong&gt; &lt;p id="totalFarmers"&gt;Loading...&lt;/p&gt; &lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="summary-item"&gt; &lt;strong&gt;Total Wheat Acres&lt;/strong&gt; &lt;p id="totalAcres"&gt;Loading...&lt;/p&gt; &lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="summary-item"&gt; &lt;strong&gt;Definite Use Conversion&lt;/strong&gt; &lt;p id="definiteUse"&gt;Loading...&lt;/p&gt; &lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="card"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;h3&gt;ğŸ—“ï¸ All Weeks Impact Overview&lt;/h3&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;p class="data-info"&gt;Compare sessions and conversion across all weeks.&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div class="table-container"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;table class="data-table" id="weekSummaryTable"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;thead&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;th&gt;Week&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;th&gt;Sessions&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;th&gt;Farmers&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;th&gt;Total Acres&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;th&gt;Definite Use Rate&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/thead&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;tbody id="weekSummaryBody"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/tbody&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/table&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;section class="session-details fade-in"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;h2&gt;ğŸ¯ Session Breakdown by Day&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="session-list" id="sessionList"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;/section&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;section class="chart-container fade-in"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;h2&gt;ğŸ“ˆ Performance Analysis&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;p class="data-info"&gt;Charts reflect the currently selected filter (Day, Week, or All Sessions).&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="charts-grid"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;canvas id="engagementChart" width="400" height="300"&gt;&lt;/canvas&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;canvas id="conversionChart" width="400" height="300"&gt;&lt;/canvas&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;canvas id="reasonsChart" width="400" height="300"&gt;&lt;/canvas&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;canvas id="distanceChart" width="400" height="300"&gt;&lt;/canvas&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;/section&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;section class="session-details fade-in"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;h2&gt;ğŸ“‹ Detailed Session Data&lt;/h2&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="table-container"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;table class="data-table" id="dataTable"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/table&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;/section&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;footer class="footer"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;p&gt;&amp;copy; 2025 Engagement Reporting. Data provided by Buctril Super Campaign.&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/footer&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;script&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// --- Configuration ---</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const CSV_FILE = 'sum sheet.csv';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const TILE_URL = 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const ATTRIBUTION = 'Â© OpenStreetMap contributors';</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// --- Global State ---</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>let map = null;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>let sessionMarkers = [];</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>let allSessionData = [];</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>let sessionData = []; // Data currently shown (filtered)</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>let charts = [];</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>let currentFilter = 'All';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>let currentFilterType = 'Day';</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// --- CSV Parsing Utility (Robust version to handle header offset and quoted fields) ---</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>function parseCSV(text) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// Find the line that starts with "SN" to locate the header</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const lines = text.trim().split('\n');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>let headerIndex = lines.findIndex(line =&gt; line.startsWith('SN,') || line.startsWith('"SN",'));</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (headerIndex === -1) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>console.error("CSV header 'SN' not found. Assuming first line is header.");</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>headerIndex = 0;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const dataText = lines.slice(headerIndex).join('\n');</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const rows = [];</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>let currentRow = [];</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>let currentField = "";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>let inQuotes = false;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>for (let i = 0; i &lt; dataText.length; i++) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const char = dataText[i];</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (inQuotes) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>if (char === '"') {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// Check for double quotes (escaped quotes)</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (i + 1 &lt; dataText.length &amp;&amp; dataText[i + 1] === '"') {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>currentField += '"';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>i++; // Skip the next quote</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>inQuotes = false;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>currentField += char;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>if (char === '"') {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>inQuotes = true;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>} else if (char === ',') {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>currentRow.push(currentField.trim());</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>currentField = "";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>} else if (char === '\n' || char === '\r') {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// Handle Windows line endings (\r\n)</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (char === '\r' &amp;&amp; i + 1 &lt; dataText.length &amp;&amp; dataText[i + 1] === '\n') {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>i++;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>currentRow.push(currentField.trim());</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>currentField = "";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// Only add non-empty rows</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (currentRow.length &gt; 0 &amp;&amp; currentRow.some(cell =&gt; cell !== "")) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>rows.push(currentRow);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>currentRow = [];</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>currentField += char;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// Add the last row if there's any data</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (currentField.trim() !== "") {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>currentRow.push(currentField.trim());</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (currentRow.length &gt; 0 &amp;&amp; currentRow.some(cell =&gt; cell !== "")) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>rows.push(currentRow);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>return rows;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// --- Helper functions ---</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>function toNumber(value) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (value === undefined || value === null || value === "") return 0;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// Remove commas, trim, and parse float</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const cleanValue = String(value).replace(/,/g, '').trim();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>return parseFloat(cleanValue) || 0;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>function safePercent(value) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const num = toNumber(value);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (num &gt; 100) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// Assume rate is a count if &gt; 100 and farmers count is available</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const totalFarmers = toNumber(sessionData[0]['Total Farmers']); // This is fragile, better to do in pre-processing</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>return num;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>return num;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>function extractLatLngFromCoordinates(coordText) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (!coordText) return null;</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// Pattern matches: 28Â°09'13.2""N 69Â°48'59.7""E</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const dmsRegex = /(\d+)Â°(\d+)'([\d.]+)\s*""([NnSs])\s*(\d+)Â°(\d+)'([\d.]+)\s*""([EeWw])/;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const match = coordText.match(dmsRegex);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (match) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const [_, latDeg, latMin, latSec, latDir, lngDeg, lngMin, lngSec, lngDir] = match;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const dmsToDecimal = (deg, min, sec, dir) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>let decimal = toNumber(deg) + toNumber(min) / 60 + toNumber(sec) / 3600;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>if (dir.toUpperCase() === 'S' || dir.toUpperCase() === 'W') {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>decimal *= -1;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>return decimal;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const lat = dmsToDecimal(latDeg, latMin, latSec, latDir);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const lng = dmsToDecimal(lngDeg, lngMin, lngSec, lngDir);</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (isNaN(lat) || isNaN(lng)) return null;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>return [lat, lng];</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}<span class="Apple-converted-space">Â </span></p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// Fallback for simple decimal coordinates (unlikely for this dataset but good practice)</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const decimalRegex = /(-?\d+\.?\d*)\s*,\s*(-?\d+\.?\d*)/;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const decimalMatch = coordText.match(decimalRegex);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (decimalMatch) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const lat = parseFloat(decimalMatch[1]);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const lng = parseFloat(decimalMatch[2]);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (!isNaN(lat) &amp;&amp; !isNaN(lng)) return [lat, lng];</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>return null;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>function getColorByAwareness(awarenessRate) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (awarenessRate &gt;= 75) return '#27ae60'; // High (Green)</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (awarenessRate &gt;= 50) return '#f39c12'; // Medium (Orange)</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>return '#c0392b'; // Low (Red)</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// --- Initialize application ---</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>function initApp() {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// Show loading</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>document.getElementById('dataStatus').textContent = 'Loading data...';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>document.getElementById('loadingOverlay').style.display = 'flex';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>document.getElementById('errorMessage').style.display = 'none';</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// Initialize map</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>initMap();</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// Load data</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>loadData();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>function initMap() {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (!map) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// Initial view over the region of interest (e.g., Pakistan)</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>map = L.map('map').setView([29.0, 70.0], 6);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>L.tileLayer(TILE_URL, { attribution: ATTRIBUTION }).addTo(map);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>async function loadData() {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>try {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>console.log('Loading CSV data from:', CSV_FILE);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// Try multiple potential file paths including the exact name and encoded versions</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const possiblePaths = [<span class="Apple-converted-space">Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>CSV_FILE,<span class="Apple-converted-space">Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>CSV_FILE.replace(/ /g, '%20'),<span class="Apple-converted-space">Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>'sum_sheet.csv',</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>'sum%20sheet.csv'<span class="Apple-converted-space">Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>];</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>let data = null;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>let lastError = null;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>for (const path of possiblePaths) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>try {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>console.log('Trying path:', path);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const response = await fetch(path);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (response.ok) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const text = await response.text();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>console.log('Successfully loaded data from:', path);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>data = text;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>break;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>} catch (err) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>lastError = err;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>console.warn('Failed to load from', path, ':', err.message);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (!data) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>throw new Error(`Failed to load CSV from any path. Last error: ${lastError ? lastError.message : 'Unknown'}`);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// Parse and process data</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const parsedRows = parseCSV(data);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (parsedRows.length &lt; 2) throw new Error('CSV is empty or only contains header.');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const headers = parsedRows[0];</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const dataRows = parsedRows.slice(1);</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const startDate = new Date('2023-11-24'); // Fixed campaign start date from CSV data (24-Nov)</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>allSessionData = dataRows.map(row =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const session = {};</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>headers.forEach((header, i) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>session[header.trim()] = row[i] ? row[i].trim() : '';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>// Add Week Number and Filterable Day</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>const dateStr = session['Date'];</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>if (dateStr &amp;&amp; dateStr.match(/^\d{1,2}-\w{3}$/)) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>// Assuming all data is from 2023 for consistent date objects</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const date = new Date(`${dateStr}-2023`);<span class="Apple-converted-space">Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>if (!isNaN(date)) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const diffTime = Math.abs(date.getTime() - startDate.getTime());</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>session.Week = `Week ${Math.max(1, Math.floor(diffDays / 7) + 1)}`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>// Remove extra quotes from coordinates if necessary</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>if (session['Spot Coordinates']) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>session['Spot Coordinates'] = session['Spot Coordinates'].replace(/^"|"$/g, '').trim();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>return session;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}).filter(s =&gt; s['Total Farmers'] &amp;&amp; toNumber(s['Total Farmers']) &gt; 0 &amp;&amp; s['Day'] !== 'Start'); // Filter out travel logs and empty sessions</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>sessionData = [...allSessionData]; // Initial state is all data</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (allSessionData.length === 0) throw new Error('No valid session data found after filtering.');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// Update status and UI</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>document.getElementById('dataStatus').textContent = `Loaded ${allSessionData.length} sessions`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>document.getElementById('dataStatus').style.background = '#2ecc71';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>document.getElementById('loadingOverlay').style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>document.getElementById('sessionCount').textContent = allSessionData.length;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>document.getElementById('updateTime').textContent = new Date().toLocaleTimeString();</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>populateFilters();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>updateUI();</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>} catch (error) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>console.error('Error loading data:', error);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// Show error</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>document.getElementById('dataStatus').textContent = 'Error loading data';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>document.getElementById('dataStatus').style.background = '#e74c3c';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>document.getElementById('loadingOverlay').style.display = 'none';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>document.getElementById('errorMessage').style.display = 'block';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>document.getElementById('errorMessage').innerHTML = `</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;p&gt;Error: ${error.message}&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;p&gt;Please ensure 'sum sheet.csv' is correctly formatted and available.&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;button onclick="retryLoad()" style="margin-top: 0.5rem; padding: 0.5rem 1rem; background: white; color: #e74c3c; border: none; border-radius: 5px; cursor: pointer;"&gt; Retry Loading &lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>function retryLoad() {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>initApp();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// --- Filtering and UI Control ---</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>function populateFilters() {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const daySelect = document.getElementById('dayFilter');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const weekSelect = document.getElementById('weekFilter');</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// Clear previous options</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>daySelect.innerHTML = '&lt;option value="All"&gt;Filter by Day&lt;/option&gt;';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>weekSelect.innerHTML = '&lt;option value="All"&gt;Filter by Week&lt;/option&gt;';</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// Get unique days and sort them by their date</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const uniqueDayNames = [...new Set(allSessionData.map(s =&gt; s['Day']).filter(Boolean))];</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const daySortMap = allSessionData.reduce((map, s) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (!map[s['Day']]) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>map[s['Day']] = new Date(`${s['Date']}-2023`).getTime();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>return map;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}, {});</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>uniqueDayNames.sort((a, b) =&gt; daySortMap[a] - daySortMap[b]);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>uniqueDayNames.forEach(day =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>daySelect.innerHTML += `&lt;option value="${day}"&gt;${day}&lt;/option&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const uniqueWeeks = [...new Set(allSessionData.map(s =&gt; s.Week).filter(Boolean))].sort();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>uniqueWeeks.forEach(week =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>weekSelect.innerHTML += `&lt;option value="${week}"&gt;${week}&lt;/option&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>});</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>daySelect.onchange = (e) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>weekSelect.value = 'All'; // Reset other filter</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>filterData('Day', e.target.value);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>};</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>weekSelect.onchange = (e) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>daySelect.value = 'All'; // Reset other filter</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>filterData('Week', e.target.value);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>};</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>function filterData(filterType, filterValue) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>currentFilterType = filterType;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>currentFilter = filterValue;</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (filterValue === 'All') {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>sessionData = [...allSessionData];</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>} else if (filterType === 'Day') {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>sessionData = allSessionData.filter(s =&gt; s['Day'] === filterValue);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>} else if (filterType === 'Week') {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>sessionData = allSessionData.filter(s =&gt; s.Week === filterValue);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>updateUI();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>function updateFilterDisplay() {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const displayEl = document.getElementById('currentFilterDisplay');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (currentFilter === 'All') {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>displayEl.textContent = 'Showing: All Sessions';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>displayEl.style.background = '#f39c12';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>displayEl.textContent = `Showing: ${currentFilterType} - ${currentFilter}`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>displayEl.style.background = '#3498db';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>function updateUI() {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>updateFilteredSummary();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>updateWeeklySummaryTable(); // This is static, but update it once data is loaded</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>updateSessionList();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>updateDataTable();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>plotMapMarkers();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>createCharts();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>updateFilterDisplay();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// --- Data Presentation Functions ---</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>function updateFilteredSummary() {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (sessionData.length === 0) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>document.getElementById('totalSessions').textContent = 0;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>document.getElementById('totalFarmers').textContent = 'N/A';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>document.getElementById('totalAcres').textContent = 'N/A';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>document.getElementById('definiteUse').textContent = 'N/A';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>return;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const totalFarmers = sessionData.reduce((sum, s) =&gt; sum + toNumber(s['Total Farmers']), 0);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const totalAcres = sessionData.reduce((sum, s) =&gt; sum + toNumber(s['Total Wheat Acres']), 0);</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const definiteUseRates = sessionData</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>.map(s =&gt; safePercent(s['Definite Use Rate']))</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>.filter(r =&gt; r &gt; 0 &amp;&amp; r &lt;= 100);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const avgDefiniteRate = definiteUseRates.length &gt; 0<span class="Apple-converted-space">Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>? (definiteUseRates.reduce((sum, rate) =&gt; sum + rate, 0) / definiteUseRates.length)</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>: 0;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>document.getElementById('totalSessions').textContent = sessionData.length;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>document.getElementById('totalFarmers').textContent = totalFarmers.toLocaleString();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>document.getElementById('totalAcres').textContent = totalAcres.toLocaleString();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>document.getElementById('definiteUse').textContent = `${avgDefiniteRate.toFixed(1)}%`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>function updateWeeklySummaryTable() {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const tableBody = document.getElementById('weekSummaryBody');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>tableBody.innerHTML = '';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (allSessionData.length === 0) return;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// 1. Group data by Week</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const weeklyData = allSessionData.reduce((acc, session) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const week = session.Week;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (!week) return acc;</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (!acc[week]) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>acc[week] = {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>sessions: [],</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>definiteUseRates: []</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>};</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const farmers = toNumber(session['Total Farmers']);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const acres = toNumber(session['Total Wheat Acres']);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const definiteRate = safePercent(session['Definite Use Rate']);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>acc[week].sessions.push(session);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// Sum up farmers and acres for the week</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>acc[week].totalFarmers = (acc[week].totalFarmers || 0) + farmers;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>acc[week].totalAcres = (acc[week].totalAcres || 0) + acres;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (definiteRate &gt; 0 &amp;&amp; definiteRate &lt;= 100) acc[week].definiteUseRates.push(definiteRate);</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>return acc;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}, {});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// 2. Calculate Averages and create rows</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const weekSummaries = Object.keys(weeklyData).sort().map(week =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const data = weeklyData[week];</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const avgDefiniteRate = data.definiteUseRates.length &gt; 0<span class="Apple-converted-space">Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>? (data.definiteUseRates.reduce((sum, rate) =&gt; sum + rate, 0) / data.definiteUseRates.length)</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>: 0;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>return {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>week: week,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>sessionsCount: data.sessions.length,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>farmers: data.totalFarmers.toLocaleString(),</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>acres: data.totalAcres.toLocaleString(),</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>definiteUseRate: `${avgDefiniteRate.toFixed(1)}%`</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>};</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// 3. Populate Table</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>let html = '';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>weekSummaries.forEach(summary =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>html += `</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;td&gt;&lt;strong&gt;${summary.week}&lt;/strong&gt;&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;td&gt;${summary.sessionsCount}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;td&gt;${summary.farmers}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;td&gt;${summary.acres}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;td&gt;${summary.definiteUseRate}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>});</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>tableBody.innerHTML = html;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>function updateSessionList() {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const container = document.getElementById('sessionList');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>container.innerHTML = '';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (sessionData.length === 0) {</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  </span>container.innerHTML = '&lt;p class="data-info" style="border-left-color: #f39c12;"&gt;No sessions to display for the current filter.&lt;/p&gt;';</p>
<p class="p1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  </span>return;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>let html = '';</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// Group by Day (even if the filter is by Week, show sessions grouped by day)</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const sessionsByDay = sessionData.reduce((acc, s) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const dayKey = s['Date'] || 'Unknown Date';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (!acc[dayKey]) acc[dayKey] = [];</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>acc[dayKey].push(s);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>return acc;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}, {});</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>Object.keys(sessionsByDay).sort().forEach(date =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const sessions = sessionsByDay[date];</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const totalFarmers = sessions.reduce((sum, s) =&gt; sum + toNumber(s['Total Farmers']), 0);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const totalAcres = sessions.reduce((sum, s) =&gt; sum + toNumber(s['Total Wheat Acres']), 0);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const definiteRate = sessions</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>.map(s =&gt; safePercent(s['Definite Use Rate']))</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>.filter(r =&gt; r &gt; 0 &amp;&amp; r &lt;= 100)</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>.reduce((sum, rate) =&gt; sum + rate, 0) / sessions.length;</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>html += `</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;div class="session-item"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;h4&gt;ğŸ—“ï¸ ${sessions[0]['Day']} (${date}) - ${sessions.length} Sessions&lt;/h4&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;p&gt;&lt;strong&gt;Farmers Engaged:&lt;/strong&gt; ${totalFarmers.toLocaleString()}&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;p&gt;&lt;strong&gt;Total Acres:&lt;/strong&gt; ${totalAcres.toLocaleString()}&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;p&gt;&lt;strong&gt;Avg Definite Use:&lt;/strong&gt; ${definiteRate.toFixed(1)}%&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;p style="font-size: 0.85rem; margin-top: 5px; opacity: 0.8;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>Locations: ${sessions</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>.map(s =&gt; s['Session Location'] || s['Village / Mauza'] || 'N/A')</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>.filter(Boolean)</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>.slice(0, 3)</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>.join(', ')}${sessions.length &gt; 3 ? '...' : ''}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>});</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>container.innerHTML = html;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>function updateDataTable() {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const table = document.getElementById('dataTable');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>table.innerHTML = '';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (sessionData.length === 0) return;</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const headers = ['Day', 'Date', 'Village / Mauza', 'Total Farmers', 'Total Wheat Acres', 'Definite Use Rate', 'Top Reason Use', 'Top Reason Not to Use in past'];</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const csvHeaders = ['Day', 'Date', 'Village / Mauza', 'Total Farmers', 'Total Wheat Acres', 'Definite Use Rate', 'Top Reason Use', 'Top Reason Not to Use in past'];</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>let html = '&lt;thead&gt;&lt;tr&gt;' + headers.map(h =&gt; `&lt;th&gt;${h}&lt;/th&gt;`).join('') + '&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;';</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// Limit display to a reasonable number of rows for performance/viewability</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const maxRows = 20;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const displayData = sessionData.slice(0, maxRows);</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>displayData.forEach(session =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>html += '&lt;tr&gt;';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>csvHeaders.forEach(csvKey =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>let value = session[csvKey] || '-';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>if (csvKey === 'Definite Use Rate' &amp;&amp; value !== '-') {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>value = `${safePercent(value).toFixed(1)}%`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>html += `&lt;td&gt;${value}&lt;/td&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>});</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>html += '&lt;/tr&gt;';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (sessionData.length &gt; maxRows) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>html += `&lt;tr&gt;&lt;td colspan="${headers.length}" style="text-align: center; font-style: italic; opacity: 0.7;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>... and ${sessionData.length - maxRows} more sessions (Apply filter or see full CSV for all data)</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/td&gt;&lt;/tr&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>html += '&lt;/tbody&gt;';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>table.innerHTML = html;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>function plotMapMarkers() {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// Clear existing markers</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>sessionMarkers.forEach(marker =&gt; map.removeLayer(marker));</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>sessionMarkers = [];</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (sessionData.length === 0) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// Reset map view to a default location (e.g., Pakistan center)</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>map.setView([29.0, 70.0], 6);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>return;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const bounds = [];</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>sessionData.forEach(session =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const coordText = session['Spot Coordinates'] || '';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const coords = extractLatLngFromCoordinates(coordText);</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (!coords) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>// console.log('No coordinates for:', session['Session Location']);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>return;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const [lat, lng] = coords;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const farmers = toNumber(session['Total Farmers']);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const acres = toNumber(session['Total Wheat Acres']);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const location = session['Session Location'] || session['Village / Mauza'] || 'Session';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const day = session['Day'] || 'Unknown';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const date = session['Date'] || 'Unknown Date';</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const awareness = safePercent(session['Awareness Rate']);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const definite = safePercent(session['Definite Use Rate']);</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>// Create marker with size based on farmers</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const radius = Math.min(Math.max(farmers / 8, 8), 30); // Radius min 8, max 30</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const marker = L.circleMarker([lat, lng], {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>radius: radius,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>fillColor: getColorByAwareness(awareness), // Color based on Awareness Rate</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>color: '#2c3e50',</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>weight: 2,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>opacity: 0.8,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>fillOpacity: 0.7</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}).addTo(map);</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>marker.bindPopup(`</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;strong&gt;${location}&lt;/strong&gt; (${day}, ${date})&lt;br&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>Farmers: ${farmers.toLocaleString()}&lt;br&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>Acres: ${acres.toLocaleString()}&lt;br&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>Awareness: ${awareness.toFixed(1)}%&lt;br&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>Definite Use: ${definite.toFixed(1)}%</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>`);</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>sessionMarkers.push(marker);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>bounds.push([lat, lng]);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>});</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// Fit map to markers</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (bounds.length &gt; 0) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>map.fitBounds(bounds, { padding: [50, 50] });</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// --- Charting Functions ---</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>function createCharts() {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>charts.forEach(chart =&gt; chart.destroy());</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>charts = [];</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (sessionData.length === 0) return;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// --- Chart 1: Engagement vs. Acres ---</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const engagementLabels = sessionData.map(s =&gt; s['Session Location'] || s['Village / Mauza']);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const farmersData = sessionData.map(s =&gt; toNumber(s['Total Farmers']));</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const acresData = sessionData.map(s =&gt; toNumber(s['Total Wheat Acres']));</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const engagementChart = new Chart(document.getElementById('engagementChart').getContext('2d'), {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>type: 'bar',</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>data: {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>labels: engagementLabels,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>datasets: [</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>{</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>label: 'Farmers Engaged',</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>data: farmersData,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>backgroundColor: 'rgba(52, 152, 219, 0.7)', // Blue</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>yAxisID: 'y'</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>},</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>{</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>label: 'Total Wheat Acres',</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>data: acresData,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>backgroundColor: 'rgba(44, 62, 80, 0.7)', // Dark Blue</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>type: 'line',</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>yAxisID: 'y1'</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>]</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>},</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>options: {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>responsive: true,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>plugins: { title: { display: true, text: 'Farmer Engagement vs. Wheat Acres' } },</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>scales: {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>y: { beginAtZero: true, position: 'left', title: { display: true, text: 'Farmers' } },</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>y1: { beginAtZero: true, position: 'right', title: { display: true, text: 'Acres' }, grid: { drawOnChartArea: false } }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>});</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>charts.push(engagementChart);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// --- Chart 2: Conversion Rates ---</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const conversionLabels = sessionData.map(s =&gt; s['Session Location'] || s['Village / Mauza']);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const awarenessData = sessionData.map(s =&gt; safePercent(s['Awareness Rate']));</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const definiteUseData = sessionData.map(s =&gt; safePercent(s['Definite Use Rate']));</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const conversionChart = new Chart(document.getElementById('conversionChart').getContext('2d'), {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>type: 'line',</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>data: {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>labels: conversionLabels,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>datasets: [</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>{</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>label: 'Awareness Rate (%)',</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>data: awarenessData,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>borderColor: '#2ecc71', // Green</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>backgroundColor: 'rgba(46, 204, 113, 0.1)',</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>fill: true,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>tension: 0.3</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>},</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>{</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>label: 'Definite Use Rate (%)',</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>data: definiteUseData,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>borderColor: '#e74c3c', // Red</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>backgroundColor: 'rgba(231, 76, 60, 0.1)',</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>fill: false,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>tension: 0.3</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>]</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>},</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>options: {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>responsive: true,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>plugins: { title: { display: true, text: 'Awareness and Definite Use Rates' } },</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>scales: { y: { beginAtZero: true, max: 100, ticks: { callback: (v) =&gt; v + '%' } } }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>});</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>charts.push(conversionChart);</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// --- Chart 3: Top Reasons for Use (Bar Chart) ---</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const reasons = sessionData.flatMap(s =&gt; s['Top Reason Use']).filter(r =&gt; r &amp;&amp; r !== '-');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const reasonCounts = reasons.reduce((acc, r) =&gt; { acc[r] = (acc[r] || 0) + 1; return acc; }, {});</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const reasonLabels = Object.keys(reasonCounts);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const reasonValues = Object.values(reasonCounts);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const reasonsChart = new Chart(document.getElementById('reasonsChart').getContext('2d'), {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>type: 'pie',</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>data: {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>labels: reasonLabels,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>datasets: [{</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>label: 'Sessions Reporting Top Reason',</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>data: reasonValues,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>backgroundColor: [</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>'#3498db', '#2ecc71', '#f39c12', '#9b59b6', '#e74c3c', '#1abc9c'</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>],</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>hoverOffset: 4</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}]</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>},</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>options: {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>responsive: true,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>plugins: { title: { display: true, text: 'Top Reasons to Use (By Sessions)' } }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>});</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>charts.push(reasonsChart);</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// --- Chart 4: Average Understanding Scores (Bar Chart) ---</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const scoreHeaders = [</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>'Score Understood: Yield Loss 20-40%',<span class="Apple-converted-space">Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>'Score Understood: Golden Period',<span class="Apple-converted-space">Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>'Score Understood: Buctril Broadleaf',<span class="Apple-converted-space">Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>'Score Understood Combine Benefit: Buctril+Atlantis',<span class="Apple-converted-space">Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>'Score: Safety PPE'</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>];</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â  Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const avgScores = scoreHeaders.map(header =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const scores = sessionData.map(s =&gt; toNumber(s[header])).filter(v =&gt; v &gt; 0);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>return scores.length &gt; 0 ? (scores.reduce((a, b) =&gt; a + b, 0) / scores.length).toFixed(2) : 0;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const distanceChart = new Chart(document.getElementById('distanceChart').getContext('2d'), {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>type: 'bar',</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>data: {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>labels: scoreHeaders.map(h =&gt; h.replace('Score Understood: ', '').replace('Score: ', '').replace('Combine Benefit: ', '')),</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>datasets: [{</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>label: 'Average Score (Max 3)',</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>data: avgScores,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>backgroundColor: 'rgba(155, 89, 182, 0.7)',</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>borderColor: '#9b59b6',</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>borderWidth: 1</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>}]</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>},</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>options: {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>responsive: true,</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>plugins: { title: { display: true, text: 'Average Understanding Scores' } },</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>scales: { y: { beginAtZero: true, max: 3 } }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>});</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>charts.push(distanceChart);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// --- Initial Call ---</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>document.addEventListener('DOMContentLoaded', initApp);</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
